при удалении одних элементов массива и наполнии новыми вы ушли за лимиты памяти

Удаляли меньше элементов чем добавляли.

