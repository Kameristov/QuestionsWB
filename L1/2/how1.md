[Назад](/L1/L1_.md) 
## как диагностировать утечку памяти или избыточное ее использование
 
- инструмент профилирования pprof
- Инструменты анализа памяти go test -race, go vet
--------------------------------------------------
Диагностика утечек памяти или избыточного ее использования в Go может быть выполнена с использованием инструментов профилирования и анализа памяти, предоставляемых стандартной библиотекой Go.

1. Инструменты профилирования:
   - go tool pprof: Этот инструмент позволяет собирать профили памяти и CPU для анализа. Вы можете использовать его для сбора профиля памяти вашей программы и анализа результатов для выявления утечек памяти или избыточного использования.
     Пример использования:
     
     go run -gcflags="-m" main.go > mem.prof
     go tool pprof mem.prof
     

   - net/http/pprof: Этот пакет позволяет включить профилирование в вашем HTTP-сервере и получить доступ к результатам профилирования через веб-интерфейс. Вы можете использовать его для анализа профилей памяти вашего сервера и выявления утечек памяти или избыточного использования.
     Пример использования:
     go
     import _ "net/http/pprof"
     

2. Инструменты анализа памяти:
   - go test -race: Этот инструмент позволяет выполнить гонки данных и анализировать использование памяти в вашем коде. Вы можете использовать его для обнаружения гонок данных и потенциальных утечек памяти.
     Пример использования:
     
     go test -race
     

   - go vet: Этот инструмент позволяет проверять ваш код на наличие ошибок, связанных с использованием памяти. Вы можете использовать его для поиска потенциальных утечек памяти или избыточного использования.
     Пример использования:
     
     go vet
     

   - golang.org/x/tools/go/analysis/passes/heapinspect: Этот инструмент позволяет анализировать использование памяти в вашем коде и выявлять потенциальные утечки памяти. Вы можете использовать его для детального анализа вашего кода и определения проблем с памятью.
     Пример использования:
     
     go install golang.org/x/tools/go/analysis/passes/heapinspect
     go vet -vettool=$(which heapinspect)
     

Эти инструменты помогут вам диагностировать утечки памяти или избыточное ее использование в вашем коде Go.